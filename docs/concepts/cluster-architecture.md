# ğŸ—ï¸ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

## æ¦‚è¦

Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚AWS ECSç®¡ç†è€…ã®è¦–ç‚¹ã‹ã‚‰ã€Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®æ§‹é€ ã¨å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å½¹å‰²ã‚’ç†è§£ã—ã¦ã„ãã¾ã™ã€‚

## ğŸ¯ å­¦ç¿’ç›®æ¨™

- Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®å…¨ä½“æ§‹é€ ã‚’ç†è§£ã™ã‚‹
- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã¨ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã®å½¹å‰²ã‚’æŠŠæ¡ã™ã‚‹
- AWS ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã®é•ã„ã‚’ç†è§£ã™ã‚‹
- å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è²¬ä»»ç¯„å›²ã‚’æŠŠæ¡ã™ã‚‹

## ğŸ›ï¸ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å…¨ä½“åƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Kubernetes Cluster                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Control Plane (Master)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ API Server  â”‚ â”‚    etcd     â”‚ â”‚ Scheduler   â”‚ â”‚Controllerâ”‚  â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚ Manager â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Worker Nodes                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚      Node 1           â”‚  â”‚      Node 2           â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   ...  â”‚
â”‚  â”‚  â”‚     kubelet     â”‚  â”‚  â”‚  â”‚     kubelet     â”‚  â”‚        â”‚
â”‚  â”‚  â”‚   kube-proxy    â”‚  â”‚  â”‚  â”‚   kube-proxy    â”‚  â”‚        â”‚
â”‚  â”‚  â”‚ Container Runtimeâ”‚  â”‚  â”‚  â”‚ Container Runtimeâ”‚  â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â” â”‚        â”‚
â”‚  â”‚  â”‚Pod 1â”‚ â”‚Pod 2â”‚ â”‚..â”‚ â”‚  â”‚  â”‚Pod 3â”‚ â”‚Pod 4â”‚ â”‚..â”‚ â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”˜ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”˜ â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ›ï¸ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ (Control Plane)

ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å…¨ä½“ã®ç®¡ç†ã¨åˆ¶å¾¡ã‚’æ‹…å½“ã—ã¾ã™ã€‚

### ğŸŒ API Server (kube-apiserver)

**å½¹å‰²**: Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ä¸­å¤®åˆ¶å¾¡ç‚¹

- **æ©Ÿèƒ½**:
  - RESTful APIã‚’æä¾›
  - èªè¨¼ãƒ»èªå¯ã®å®Ÿè¡Œ
  - etcdã¨ã®é€šä¿¡ä»²ä»‹
  - webhook ã®å®Ÿè¡Œ

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - ECS APIã«ç›¸å½“
  - ãŸã ã—ã€ECSã‚ˆã‚Šè±Šå¯Œãªæ©Ÿèƒ½ã‚’æä¾›

**å®Ÿç”¨ä¾‹**:
```bash
# API Serverã¨ã®é€šä¿¡ä¾‹
kubectl get nodes
kubectl apply -f deployment.yaml
kubectl logs pod-name
```

### ğŸ’¾ etcd

**å½¹å‰²**: åˆ†æ•£ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ï¼ˆã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®çŠ¶æ…‹ä¿å­˜ï¼‰

- **æ©Ÿèƒ½**:
  - ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼è¨­å®šãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
  - å…¨ãƒªã‚½ãƒ¼ã‚¹ã®ç¾åœ¨çŠ¶æ…‹ã‚’ä¿æŒ
  - åˆ†æ•£åˆæ„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆRaftï¼‰ã«ã‚ˆã‚‹ä¸€è²«æ€§ä¿è¨¼

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - ECSã§ã¯ AWS å†…éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ãŒåŒæ§˜ã®å½¹å‰²
  - etcdã¯ç›´æ¥æ“ä½œå¯èƒ½ï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰

**é‡è¦ãªæ¦‚å¿µ**:
```bash
# etcdã‹ã‚‰ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
etcdctl get /registry/pods/default/my-pod
```

### ğŸ“… Scheduler (kube-scheduler)

**å½¹å‰²**: Podã‚’é©åˆ‡ãªãƒãƒ¼ãƒ‰ã«é…ç½®ã™ã‚‹

- **æ©Ÿèƒ½**:
  - ãƒãƒ¼ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ³ã‚’è©•ä¾¡
  - ã‚¢ãƒ•ã‚£ãƒ‹ãƒ†ã‚£ãƒ»ã‚¢ãƒ³ãƒã‚¢ãƒ•ã‚£ãƒ‹ãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®é©ç”¨
  - ãƒªã‚½ãƒ¼ã‚¹è¦æ±‚ã«åŸºã¥ãæœ€é©é…ç½®

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - ECS Schedulerã«ç›¸å½“
  - ã‚ˆã‚Šç´°ã‹ã„åˆ¶å¾¡ãŒå¯èƒ½

**ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¦å› **:
```yaml
# Podã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã®ä¾‹
apiVersion: v1
kind: Pod
spec:
  nodeSelector:
    environment: production
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: zone
            operator: In
            values: ["us-west-1a", "us-west-1b"]
```

### ğŸ® Controller Manager (kube-controller-manager)

**å½¹å‰²**: æ§˜ã€…ãªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®å®Ÿè¡Œ

- **ä¸»è¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼**:
  - **ReplicaSet Controller**: Podæ•°ã®ç®¡ç†
  - **Deployment Controller**: ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
  - **Service Controller**: Service ã® endpoint ç®¡ç†
  - **Node Controller**: ãƒãƒ¼ãƒ‰ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - ECSã‚µãƒ¼ãƒ“ã‚¹ã®è‡ªå‹•ç®¡ç†æ©Ÿèƒ½ã«ç›¸å½“
  - ã‚ˆã‚Šå¤šãã®ç¨®é¡ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†

## ğŸ–¥ï¸ ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ (Worker Nodes)

ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã¯ã€å®Ÿéš›ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œã™ã‚‹ãƒã‚·ãƒ³ã§ã™ã€‚

### ğŸ¤– kubelet

**å½¹å‰²**: ãƒãƒ¼ãƒ‰ä¸Šã®Podç®¡ç†ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

- **æ©Ÿèƒ½**:
  - API Serverã‹ã‚‰ã®æŒ‡ç¤ºã‚’å—ä¿¡
  - Podã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
  - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®å®Ÿè¡Œ
  - ãƒãƒ¼ãƒ‰çŠ¶æ…‹ã®å ±å‘Š

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - ECS Agentã«ç›¸å½“
  - ã‚ˆã‚Šç›´æ¥çš„ãªã‚³ãƒ³ãƒ†ãƒŠåˆ¶å¾¡

**kubeletã®å½¹å‰²**:
```bash
# kubeletã®ãƒ­ã‚°ç¢ºèª
journalctl -u kubelet -f

# ãƒãƒ¼ãƒ‰ã®çŠ¶æ…‹ç¢ºèª
kubectl describe node worker-node-1
```

### ğŸŒ kube-proxy

**å½¹å‰²**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ã‚­ã‚·ã¨ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼

- **æ©Ÿèƒ½**:
  - Serviceã®å®Ÿè£…
  - ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®è² è·åˆ†æ•£
  - iptables/IPVS ãƒ«ãƒ¼ãƒ«ã®ç®¡ç†

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - AWS Load Balancerã®ä¸€éƒ¨æ©Ÿèƒ½ã‚’ãƒãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã§å®Ÿè£…
  - ã‚ˆã‚Šç´°ã‹ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ¶å¾¡

**kube-proxyã®å‹•ä½œ**:
```bash
# Service ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¢ºèª
kubectl get endpoints my-service

# kube-proxy ã®è¨­å®šç¢ºèª
kubectl get configmap kube-proxy-config -n kube-system -o yaml
```

### ğŸ³ Container Runtime

**å½¹å‰²**: å®Ÿéš›ã®ã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œ

- **å¯¾å¿œãƒ©ãƒ³ã‚¿ã‚¤ãƒ **:
  - **containerd**: æœ€ã‚‚ä¸€èˆ¬çš„
  - **CRI-O**: RedHatç³»
  - **Docker**: å¾“æ¥ã®é¸æŠè‚¢

- **AWS ECSã¨ã®æ¯”è¼ƒ**:
  - ECSã§ã‚‚Dockerã¾ãŸã¯containerdã‚’ä½¿ç”¨
  - CRI (Container Runtime Interface) ã§ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’æŠ½è±¡åŒ–

## ğŸ†š AWS ECS vs Kubernetes ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¯”è¼ƒ

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | AWS ECS | Kubernetes |
|----------------|---------|------------|
| **åˆ¶å¾¡å±¤** | ECS Control Plane (AWSç®¡ç†) | Control Plane (è‡ªå·±ç®¡ç†ã¾ãŸã¯ãƒãƒãƒ¼ã‚¸ãƒ‰) |
| **API** | ECS API | Kubernetes API Server |
| **çŠ¶æ…‹ç®¡ç†** | AWSå†…éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ | etcd |
| **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼** | ECS Scheduler | kube-scheduler |
| **ãƒãƒ¼ãƒ‰ç®¡ç†** | EC2 Auto Scaling Group | Node Controller |
| **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ** | ECS Agent | kubelet |
| **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯** | ALB/NLB + Security Groups | kube-proxy + Service |
| **ã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œ** | Docker/containerd | CRIå¯¾å¿œãƒ©ãƒ³ã‚¿ã‚¤ãƒ  |

## ğŸ”§ AWS EKS ã§ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

AWS EKSä½¿ç”¨æ™‚ã®ç‰¹å¾´ï¼š

### ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AWS EKS                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚     Managed Control Plane          â”‚â”‚
â”‚  â”‚  (AWS ãŒç®¡ç†ãƒ»é‹ç”¨)                  â”‚â”‚
â”‚  â”‚                                     â”‚â”‚
â”‚  â”‚  âœ… é«˜å¯ç”¨æ€§ä¿è¨¼                     â”‚â”‚
â”‚  â”‚  âœ… è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ                 â”‚â”‚
â”‚  â”‚  âœ… æš—å·åŒ–                          â”‚â”‚
â”‚  â”‚  âœ… ç›£æŸ»ãƒ­ã‚°                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Customer VPC                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Worker Node â”‚  â”‚ Worker Node â”‚  ...  â”‚
â”‚  â”‚  (EC2/Fargate) â”‚  â”‚ (EC2/Fargate) â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### EKS Fargateã®å ´åˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AWS EKS                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚     Managed Control Plane          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Fargate                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Serverless Worker Nodes           â”‚â”‚
â”‚  â”‚  (ãƒãƒ¼ãƒ‰ç®¡ç†ä¸è¦)                    â”‚â”‚
â”‚  â”‚                                     â”‚â”‚
â”‚  â”‚  âœ… Podå˜ä½ã§ã®èª²é‡‘                  â”‚â”‚
â”‚  â”‚  âœ… è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°                 â”‚â”‚
â”‚  â”‚  âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†é›¢                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” å®Ÿè·µçš„ãªç¢ºèªã‚³ãƒãƒ³ãƒ‰

### ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å…¨ä½“ã®ç¢ºèª
```bash
# ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æƒ…å ±ã®ç¢ºèª
kubectl cluster-info

# ãƒãƒ¼ãƒ‰ä¸€è¦§ã®ç¢ºèª
kubectl get nodes -o wide

# ã‚·ã‚¹ãƒ†ãƒ Podã®ç¢ºèª
kubectl get pods -n kube-system

# ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
kubectl version
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¥å…¨æ€§ç¢ºèª
```bash
# ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçŠ¶æ…‹ç¢ºèª
kubectl get componentstatuses

# API Server ã®ç¢ºèª
kubectl get --raw=/healthz

# etcd ã®ç¢ºèª
kubectl get events --sort-by=.metadata.creationTimestamp

# Controller Manager ã®ç¢ºèª
kubectl get pods -n kube-system -l component=kube-controller-manager
```

### ãƒãƒ¼ãƒ‰è©³ç´°ã®ç¢ºèª
```bash
# ç‰¹å®šãƒãƒ¼ãƒ‰ã®è©³ç´°æƒ…å ±
kubectl describe node <node-name>

# ãƒãƒ¼ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡
kubectl top nodes

# ãƒãƒ¼ãƒ‰ã®Podä¸€è¦§
kubectl get pods --all-namespaces -o wide --field-selector spec.nodeName=<node-name>
```

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **API Server**:
  - TLSæš—å·åŒ–ã®å¿…é ˆåŒ–
  - RBAC ã«ã‚ˆã‚‹èªå¯åˆ¶å¾¡
  - Admission Controllers ã®æ´»ç”¨

- **etcd**:
  - ãƒ‡ãƒ¼ã‚¿æš—å·åŒ– (encryption at rest)
  - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†é›¢
  - å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### ãƒãƒ¼ãƒ‰ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **OS ãƒ¬ãƒ™ãƒ«**:
  - æœ€å°æ¨©é™ã®åŸå‰‡
  - å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒé©ç”¨
  - ãƒ­ã‚°ç›£è¦–

- **Container Runtime**:
  - érootå®Ÿè¡Œã®æ¨å¥¨
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³
  - ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™ã®è¨­å®š

## ğŸ”„ é«˜å¯ç”¨æ€§ã¨ãƒ‡ã‚£ã‚¶ã‚¹ã‚¿ãƒªã‚«ãƒãƒª

### ãƒãƒ«ãƒãƒã‚¹ã‚¿ãƒ¼æ§‹æˆ
```bash
# è¤‡æ•°ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒãƒ¼ãƒ‰
kubectl get nodes -l node-role.kubernetes.io/control-plane

# etcd ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ç¢ºèª
kubectl get pods -n kube-system -l component=etcd
```

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥
```bash
# etcd ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
etcdctl snapshot save backup.db \
  --endpoints=https://127.0.0.1:2379 \
  --cacert=/etc/kubernetes/pki/etcd/ca.crt \
  --cert=/etc/kubernetes/pki/etcd/server.crt \
  --key=/etc/kubernetes/pki/etcd/server.key

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ç¢ºèª
etcdctl snapshot status backup.db
```

## ğŸ“Š ç›£è¦–ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾ç­–

#### API Server ã«æ¥ç¶šã§ããªã„
```bash
# æ¥ç¶šãƒ†ã‚¹ãƒˆ
kubectl version --short

# è¨­å®šç¢ºèª
kubectl config view

# è¨¼æ˜æ›¸ç¢ºèª
openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text -noout
```

#### Pod ãŒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œãªã„
```bash
# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã®çŠ¶æ…‹ç¢ºèª
kubectl get events --sort-by=.metadata.creationTimestamp

# ãƒãƒ¼ãƒ‰ã®çŠ¶æ…‹ç¢ºèª
kubectl describe nodes

# ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ç¢ºèª
kubectl top nodes
kubectl top pods --all-namespaces
```

#### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ã®å•é¡Œ
```bash
# kube-proxy ã®çŠ¶æ…‹ç¢ºèª
kubectl get pods -n kube-system -l k8s-app=kube-proxy

# Service ã®ç¢ºèª
kubectl get services --all-namespaces
kubectl get endpoints --all-namespaces

# DNS ç¢ºèª
nslookup kubernetes.default.svc.cluster.local
```

## ğŸ”— æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç†è§£ãŒã§ããŸã‚‰ã€ä»¥ä¸‹ã®ãƒˆãƒ”ãƒƒã‚¯ã«é€²ã‚“ã§ãã ã•ã„ï¼š

1. **[ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰](./workloads.md)** - Podã€Deploymentã€Serviceã®è©³ç´°
2. **[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°](./networking.md)** - ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…å¤–ã®é€šä¿¡
3. **[ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](./security.md)** - RBAC ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼
4. **[ãƒãƒ³ã‚ºã‚ªãƒ³ãƒ©ãƒœ](../../hands-on-labs/)** - å®Ÿéš›ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ“ä½œ

## ğŸ“š é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

- [Kubernetes Components](https://kubernetes.io/docs/concepts/overview/components/)
- [AWS EKS Architecture](https://docs.aws.amazon.com/eks/latest/userguide/eks-architecture.html)
- [etcd Documentation](https://etcd.io/docs/)
- [Container Runtime Interface (CRI)](https://kubernetes.io/docs/concepts/architecture/cri/)

---

**AWS ECSçµŒé¨“è€…ã¸ã®ãƒã‚¤ãƒ³ãƒˆ**: ECSã§ã¯AWSãŒå…¨ã¦ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ç®¡ç†ã—ã¦ã„ã¾ã—ãŸãŒã€Kubernetesã§ã¯ï¼ˆEKSã‚’ä½¿ç”¨ã—ã¦ã‚‚ï¼‰ã‚ˆã‚Šå¤šãã®è¨­å®šã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¯èƒ½ã§ã™ã€‚ã“ã®æŸ”è»Ÿæ€§ã“ããŒKubernetesã®æœ€å¤§ã®ç‰¹å¾´ã§ã™ã€‚
